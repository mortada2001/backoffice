if (coords.length !== 2 || coords.some(isNaN)) {
                    this.showError('صيغة إحداثيات غير صحيحة! مثال: 33.2625977,44.4070566');
                    return;
                }

                this.map.flyTo(coords, 22, {
                    animate: true,
                    duration: 1.5
                });

                L.marker(coords)
                    .addTo(this.map)
                    .bindPopup(<b>Target location</b><br>latitude: ${coords[0]}<br>longitude: ${coords[1]})
                    .openPopup();
            }

            showLoading() {
                document.getElementById('loading').style.opacity = '1';
                document.getElementById('loading').style.pointerEvents = 'all';
            }

            hideLoading() {
                document.getElementById('loading').style.opacity = '0';
                document.getElementById('loading').style.pointerEvents = 'none';
            }

            showError(message) {
                const errorEl = document.createElement('div');
                errorEl.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 1rem;
                    background: #e74c3c;
                    color: black;
                    border-radius: 8px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                    z-index: 1001;
                `;
                errorEl.textContent = message;
                document.body.appendChild(errorEl);
                
                setTimeout(() => errorEl.remove(), 3000);
            }
        }

        // بدء التطبيق
        document.addEventListener('DOMContentLoaded', () => new EnhancedMap());
    </script>
</body>
</html>
